test_x64_windows:
  stage: test
  tags:
    - x64_windows
    - scilab
  variables:
      GIT_CLEAN_FLAGS: none
  needs:
    - job: build_x64_windows_branch
      artifacts: false
    - job: set_x64_windows_env
      artifacts: true
  script: call .gitlab-ci\test.bat
  artifacts:
    when: always
    paths:
      - $TEST.xml
    reports:
      junit: $TEST.xml
  parallel:
    matrix:
      - TEST:
        - ast
        - core
        - fileio
        - functions
        - jvm
        - time

test_x86_64-linux-gnu:
  stage: test
  tags:
    - x86_64-linux-gnu
    - scilab
  variables:
      GIT_CLEAN_FLAGS: none
  needs:
    - job: build_x86_64-linux-gnu_branch
      artifacts: false
    - job: set_x86_64-linux-gnu_env
      artifacts: true
  script: bash -e -x .gitlab-ci/test.sh
  artifacts:
    when: always
    paths:
      - $TEST.xml
    reports:
      junit: $TEST.xml
  parallel:
    matrix:
      - TEST:
        - ast
        - core
        - fileio
        - functions
        - jvm
        - time
