test_windows_x64:
  stage: test
  tags:
    - windows_x64
    - scilab
  variables:
      GIT_CLEAN_FLAGS:: none
  needs:
    - build_windows_x64_branch
  script: .gitlab-ci/test.bat
  artifacts:
    when: always
    paths:
      - $TEST.xml
    reports:
      junit: $TEST.xml
  parallel:
    matrix:
      - TEST:
        - ast
        - core
        - fileio
        - functions
        - jvm
        - time

test_x86_64-linux-gnu:
  stage: test
  tags:
    - x86_64-linux-gnu
    - scilab
  variables:
      GIT_CLEAN_FLAGS:: none
  needs:
    - build_x86_64-linux-gnu_branch
  script: bash -e -x .gitlab-ci/test.sh
  artifacts:
    when: always
    paths:
      - $TEST.xml
    reports:
      junit: $TEST.xml
  parallel:
    matrix:
      - TEST:
        - ast
        - core
        - fileio
        - functions
        - jvm
        - time
