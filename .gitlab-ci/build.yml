# build scilab using a windows runner
build windows x64:
  stage: build
  tags:
    - windows x64
    - visual studio 2017
    - intel oneAPI
    - openjdk 8
    - innosetup 6
  cache:
    key: prerequirements-windows-x64
    policy: pull
  variables:
      GIT_CLEAN_FLAGS: none
  script:
    - call .gitlab-ci\bld.bat

# build scilab using a linux runner
build linux x86_64:
  stage: build
  tags:
    - linux x86_64
    - g++
    - gfortran
    - openjdk 8
  cache:
    key: prerequirements-linux-x86_64
    policy: pull
  variables:
      GIT_CLEAN_FLAGS: none
  script: .gitlab-ci/bld.sh
  artifacts:
    paths:
      - scilab-branch-${CI_COMMIT_REF_NAME}-${CI_COMMIT_TIMESTAMP}

# build scilab using the docker image
build docker:
  stage: build
  image: $CI_REGISTRY/scilab/scilab:builder_linux
  tags:
    - docker
  cache:
    key: prerequirements-linux-x86_64
    policy: pull
  variables:
      GIT_CLEAN_FLAGS: none
  script: .gitlab-ci/bld.sh
  artifacts:
    paths:
      - scilab-branch-${CI_COMMIT_REF_NAME}-${CI_COMMIT_TIMESTAMP}
