release:
  stage: publish
  tags: [x86_64-linux-gnu, docker, scilab]
  variables:
      GIT_CLEAN_FLAGS: none
  script:
    - echo "nothing to deploy"
  when: manual

# generate index.html files for each directory in public/
index_gitlab_pages:
  stage: publish
  tags: [x86_64-linux-gnu, docker, scilab]
  variables:
      GIT_CLEAN_FLAGS: none
  script:
    -|
     find public -type d -print0 | while IFS= read -r -d '' d; do
       cd $CI_PROJECT_DIR/$d;
       echo '<html><body>' >index.html;
       find -name *.html -printf '<a href="%p">%p</a>\n' >>index.html;
       echo '</body></html>' >>index.html;
     done;
  artifacts:
    paths:
      - public
